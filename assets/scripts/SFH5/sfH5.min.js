var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},$SF;!function(e){function t(e,t){for(var i=e.toString().length,n=""+e;t>i;)n="0"+n,i++;return n}function i(){return U}function n(){try{return void(U=window.sfplatform?parseInt(window.sfplatform()):window.sfImp?e.ANDROID:window.wx?window.qq?e.QQ:e.WX:window.qq?e.QQ:e.WEB)}catch(t){}return void 0===U&&(U=e.WEB),U}function r(t){switch(i()){case e.ANDROID:Gt=Xt;break;case e.IOS:Gt=qt;break;default:Gt=Wt}Gt.comInit(t)}function a(e,t){var i=document.createElement("a");i.download=e,i.href=t;var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(n)}function o(e){for(var t,i,n,r="",a=0;a<e.length;)t=e.charCodeAt(a),128>t?(r+=String.fromCharCode(t),a++):t>191&&224>t?(i=e.charCodeAt(a+1),r+=String.fromCharCode((31&t)<<6|63&i),a+=2):(i=e.charCodeAt(a+1),n=e.charCodeAt(a+2),r+=String.fromCharCode((15&t)<<12|(63&i)<<6|63&n),a+=3);return r}function s(e){var t,i,n,r,a,s,c,d="",u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)r=Et.indexOf(e.charAt(u++)),a=Et.indexOf(e.charAt(u++)),s=Et.indexOf(e.charAt(u++)),c=Et.indexOf(e.charAt(u++)),t=r<<2|a>>4,i=(15&a)<<4|s>>2,n=(3&s)<<6|c,d+=String.fromCharCode(t),64!=s&&(d+=String.fromCharCode(i)),64!=c&&(d+=String.fromCharCode(n));return d=o(d)}function c(e){var t=document.createElement("iframe");t.setAttribute("src",e),t.setAttribute("style","display:none;"),t.setAttribute("height","0px"),t.setAttribute("width","0px"),t.setAttribute("frameborder","0"),document.body.appendChild(t),t.parentNode.removeChild(t)}function d(e){return(E+e).replace("-","")}function u(t,n,r){void 0===r&&(r=!0);var a=d(t);return window[a]=function(o){i()==e.IOS&&(o=s(o));var c=o;o&&o.length>256&&(c=o.substr(0,128)+"..."),h(" callbackFN "+t+" data:"+c),n?n(o):h("dummy:"+t),r&&(window[a]=void 0)},a}function l(e,t,i){void 0===i&&(i=!1);var n=d(e);return window[n]=function(e){t?t(e):h("dummy:"+n),i&&(window[n]=void 0)},n}function p(e,t){return window[e]?window[e](t):void 0}function f(e){if("string"==typeof e)try{var t=JSON.parse(e);return"object"==typeof t&&t?!0:!1}catch(i){return!1}}function h(n){if(1!=M)switch(i()){case e.IOS:console.log("["+B+"]"+n);break;case e.ANDROID:console.info("["+B+"]"+n);break;default:var r=new Date,a="["+t(r.getHours(),2)+":"+t(r.getMinutes(),2)+":"+t(r.getSeconds(),2)+"."+t(r.getMilliseconds(),3)+"]["+B+"]"+n,o=new Error;if(o.stack){var s=o.stack.split("\n");a=a+" "+s[3]}console.info(a)}}function _(e){for(var t=[],i=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);128>r?t[i++]=r:2048>r?(t[i++]=r>>6|192,t[i++]=63&r|128):55296==(64512&r)&&n+1<e.length&&56320==(64512&e.charCodeAt(n+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++n)),t[i++]=r>>18|240,t[i++]=r>>12&63|128,t[i++]=r>>6&63|128,t[i++]=63&r|128):(t[i++]=r>>12|224,t[i++]=r>>6&63|128,t[i++]=63&r|128)}return t}function g(e){for(var t=[],i=0,n=0;i<e.length;){var r=e[i++];if(128>r)t[n++]=String.fromCharCode(r);else if(r>191&&224>r){var a=e[i++];t[n++]=String.fromCharCode((31&r)<<6|63&a)}else if(r>239&&365>r){var a=e[i++],o=e[i++],s=e[i++],c=((7&r)<<18|(63&a)<<12|(63&o)<<6|63&s)-65536;t[n++]=String.fromCharCode(55296+(c>>10)),t[n++]=String.fromCharCode(56320+(1023&c))}else{var a=e[i++],o=e[i++];t[n++]=String.fromCharCode((15&r)<<12|(63&a)<<6|63&o)}}return t.join("")}function v(e){for(var t=_(e),i=t.length,n=new ArrayBuffer(i+ei),r=new Uint8Array(n),a=[],o=0;ei>o;o++)r[o]=256*Math.random()|0,a.push((255&r[o])+i+(3*o+2)&255);for(var s=(255&a[0])+(255&a[1]),o=0;i>o;o++){var c=o%ei,d=a[c];d=255&(d^ti[15&o]),d=255&(d<<1|d>>7&1),a[c]=d;var u=s+o+(255&ti[15&o])+d&7,l=255&(255&t[o]^d);l=l>>u|l<<8-u,r[o+ei]=l}return n}function y(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));for(var t=e.length-ei,i=[],n=0;ei>n;n++)i.push((255&e[n])+t+(3*n+2)&255);for(var r=[],a=(255&i[0])+(255&i[1]),n=0;t>n;n++){var o=n%ei,s=i[o];s=255&(s^ti[15&n]),s=255&(s<<1|s>>7&1),i[o]=s;var c=a+n+(255&ti[15&n])+s&7,d=e[n+ei];d=255&(d<<c|(255&d)>>8-c),r.push(255&(d^s))}return g(r)}var m="sfgamecenter:",w="S",S="P",O="A",b="D",A="G";e.WEB=0,e.ANDROID=1,e.IOS=2,e.WX=3,e.QQ=4,e.PROP_PLATFORM="sys.platform",e.PROP_RELEASE="sys.build.release",e.PROP_DEVICE_ID="deviceId",e.PROP_CMD_VIB="cmd.vibration",e.PROP_CMD_CLEARALL="cmd.clearAll",e.PROP_CMD_CLEARDATA="cmd.clearData",e.PROP_UID="uid",e.PROP_TOKEN="token",e.PROP_USER_NAME="nick",e.PROP_USER_ICON_URL="icUrl",e.PROP_RETRY_CNT="prop.retryCnt";var P="rCnt";e.PROP_CHECK="check",e.PROP_EN_EFFECT="enEffect",e.PROP_EN_MUSIC="enMusic",e.PROP_APP_VER="gc_ver";var x,E="_$CB$",C="loginQQ",D="logoutQQ",I="loginWX",T="logoutWX",k="share",R="joinQQGroup",N="retweetsReq";!function(e){e[e.AndroidApp=1]="AndroidApp",e[e.H5App=2]="H5App",e[e.H5Res=3]="H5Res"}(x||(x={}));var M,U,B,V,L,F="update",J="restart",H="loadErr",G="appUploadEvent",K="exit",j="onBack",W="onPause",q="onResume",X="onPauseG",Q="onResumeG",z="daList",$="daPreload",Y="daPlay",Z="daClosePlay",et="daShowBannerView",tt="doDaPlay",it="doDaStop",nt="P_Action",rt="P_eAction",at="P_rAction",ot="P_sAction",st="ga_",ct="gaBack",dt="roundEnd",ut="roundStart",lt="g_share",pt="resLoad",ft="hutui",ht="hutuiReq",_t="sf_sub_iframe",gt="sf_sub_view",vt="sfinframemessage",yt="main_view",mt="focus",wt="blur",St="app_blur",Ot="app_focus",bt="back",At="launch",Pt="switchview",xt="dispatchmsg",Et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ct=0,Dt="margin: auto;width: 100%;height: 100%; overflow-x: hidden; overflow-y: hidden;border:none;position:absolute",It=2,Tt="https://testfsbn.snowfish.cn:8312",kt="https://hutui.appgames.cn:8308",Rt="/hutui/mat/req/",Nt="/hutui/mat/hts/",Mt="sf",Ut="postHomeMsg";e.saveToFile=a;var Bt=function(){function e(){}return e.isSupport=function(){var e=Gt.prop("issupport");return(void 0===e||null===e)&&(e="{}"),e},e.loginQQ=function(e){Gt.invoke(w,C,[u(C,e,!0)])},e.logoutQQ=function(e){Gt.invoke(w,D,[u(D,e,!0)])},e.loginWX=function(e){Gt.invoke(w,I,[u(I,e,!0)])},e.logoutWX=function(e){Gt.invoke(w,T,[u(T,e,!0)])},e.share=function(e,t){Gt.invoke(w,k,[u(k,t,!0),JSON.stringify(e)])},e.joinQQGroup=function(e,t){Gt.invoke(w,R,[e,t])},e}();e.SFSocial=Bt,__reflect(Bt.prototype,"$SF.SFSocial");var Vt=function(){function e(){}return e.action=function(t,i){var n=function(t){var n=JSON.parse(t);if(i){var r=void 0;switch(n.r){case"ok":r=e.OK;break;case"cancel":r=e.Cancel;break;default:r=e.Fail}i(r,n.orderId,n.productId,n.msg)}return!0};Gt.invoke(S,nt,[u(nt+t.productId,n,!0),t.productId,t.price,t.productName,t.orderId])},e.finishAction=function(e,t){Gt.invoke(S,rt,[u(rt+e.productId,t,!0),e.productId,e.orderId])},e.onResumeAction=function(t){var i=function(i){var n=JSON.parse(i);if(t){var r=void 0;switch(n.r){case"ok":r=e.OK;break;case"cancel":r=e.Cancel;break;default:r=e.Fail}t(r,n.orderId,n.productId,n.msg)}return!0};u(at,i,!1)},e.restoreAction=function(e){Gt.invoke(S,ot,[u(ot,e,!0)])},e.OK=0,e.Fail=1,e.Cancel=2,e}();e.SFPay=Vt,__reflect(Vt.prototype,"$SF.SFPay");var Lt,Ft=[],Jt=[],Ht=function(){function t(){}return t._initExitBtn=function(){Lt||(Lt=document.createElement("img"),Lt.src="res/home.png",Lt.style.cssText="z-index:1000001;position:absolute;right:10px;top:10px;",Lt.onclick=function(){Gt.back()},Lt.onmousedown=function(){Lt.style.right="9px",Lt.style.top="11px"},Lt.onmouseout=function(){Lt.style.right="10px",Lt.style.top="10px"},document.body.appendChild(Lt)),Lt.style.display=""},t._hiddenExitBtn=function(){Lt&&(Lt.style.right="10px",Lt.style.top="10px",Lt.style.display="none")},t._showExitBtn=function(){Lt&&(Lt.style.display="")},t._frameName=function(e){return e==Ct?yt:_t+e},t._loadURLInFrame=function(e,i,n,r,a,o){var s=this;h("subUrl:"+i+" url:"+e);var c=parent.document.createElement("iframe");c.setAttribute("id",t._frameName(i)),c.setAttribute("src",e);var d=Dt,u=window.screen.height/window.screen.width;if(a){if(u=window.screen.width/window.screen.height,r>u){var l=window.screen.width/r;d="margin: auto;width: "+l+"px;height: 100%; align=absmiddle"}}else if(r>u){var l=window.screen.height/r;d="margin: auto;width: "+l+"px;height: 100%; align=absmiddle"}c.setAttribute("style",d),parent.document.body.appendChild(c),o&&(c.onload=function(){s._initExitBtn(),o(!0)},c.onerror=function(e){o(!1),h("_loadURLInFrame onerror:"+e)}),Jt.push(i)},t._postMsg=function(e,i,n){if(e==i){h("skip _postMsg [self:"+i+"]:"+JSON.stringify(n));var r=vt+JSON.stringify(n);t._onEngine(r)}else if(e==Ct){var r=vt+JSON.stringify(n);h("_postMsg ["+i+"-> 0(app)]:"+JSON.stringify(n)),window.parent.postMessage(r,"*")}else{var a=parent.document.getElementById(t._frameName(e));if(a){h("_postMsg ["+i+"->"+e+"(game)]:"+JSON.stringify(n));var r=vt+JSON.stringify(n);a.contentWindow.postMessage(r,a.src)}else h("dummy iframe")}},t._cmdSwitch=function(e){var i=document.getElementById(t._frameName(e.gid));if(!i)return void h("_cmdSwitch err1:"+JSON.stringify(e));var n=parent.document.getElementById(t._frameName(e.target_gameId));n?(e.mode===It?(e.target_gameId!=Ct&&n.setAttribute("style",Dt),n.style.zIndex="2",i.style.zIndex="1"):i.style.display="none",n.style.display="block",Ft.push(e.target_gameId),h("_cmdSwitch "+e.gid+"<->"+e.target_gameId+" showIframe.contentWindow == window?"+(n.contentWindow==window)),e.target_gameId>0?(h("[focus] try game focus in _cmdSwitch"),t._postMsg(e.target_gameId,e.gid,{cmd:mt}),t._showExitBtn()):(h("[focus] try app focus in _cmdSwitch"),t._postMsg(0,e.gid,{cmd:mt}),t._hiddenExitBtn())):h("_cmdSwitch err2:"+JSON.stringify(e))},t._closeclose=function(e,i,n){h("_closeclose hideGameId:"+e+" showGameId:"+i+" rm:"+n);var r=document.getElementById(t._frameName(e));r&&(r.style.zIndex="0",r.style.display="none",n&&e!=Ct&&parent.document.body.removeChild(r));var a=parent.document.getElementById(t._frameName(i));a&&(r.style.zIndex="0",a.style.display="block",i>0?(h("[focus] try game focus in _closeclose"),t._postMsg(i,e,{cmd:mt})):(h("[focus] try app focus in _closeclose"),t._postMsg(0,e,{cmd:mt}),window[d(ct)]&&window[d(ct)](e)))},t._cmdClose=function(){if(h(" _cmdClose _luanchView.length: "+Jt.length+" _switchView.length:"+Ft.length),1!==Jt.length)if(0!==Ft.length){var e,i=Ft.pop();Ft.length>0?(e=Ft[Ft.length-1],t._closeclose(i,e,!1)):(e=Jt[Jt.length-1],t._closeclose(i,e,!0)),0==e?t._hiddenExitBtn():t._showExitBtn()}else{var i=Jt.pop(),e=Jt[Jt.length-1];0==e&&t._hiddenExitBtn(),t._closeclose(i,e,!0)}},t._cmdDispatchMsg=function(e){if(e.cbn&&window[e.cbn])window[e.cbn](e.d);else if(e.gid>0){h("!! _cmdDispatchMsg no callback:"+e.cbn);for(var t in window)t.substr(0,5)==E&&h("dump method:"+t)}},t._onEngine=function(e){if(h("_recv msg:"+e),new RegExp(vt).test(e)){var i=e.slice(vt.length,e.length),n=JSON.parse(i);switch(n.cmd){case Pt:t._cmdSwitch(n);break;case bt:t._cmdClose();break;case xt:t._cmdDispatchMsg(n);break;case mt:h("on CMD_FOCUS"),L(),window[d(Q)]&&window[d(Q)]();break;case wt:h("on CMD_BLUR"),V(),window[d(X)]&&window[d(X)]();break;case St:h("on CMD_APP_PAUSE"),V(),window[d(X)]&&window[d(X)]();break;case Ot:h("on CMD_APP_RESUME"),L(),window[d(Q)]&&window[d(Q)]()}}},t.registerEventListener=function(){window.addEventListener("message",function(e){void 0!==e.data&&t._onEngine(e.data)},!1)},t.launchH5=function(e){if(0!==Ft.length)return void h("!! skip launchH5 _switchView.length:"+Ft.length);for(var i=0;i<Jt.length;i++)if(Jt[i]===e.gid)return void h("error same id");if(!e.isBgLaunch){var n;if(0!=Jt.length&&(n=Jt[Jt.length-1]),n){var r=document.getElementById(t._frameName(n));r&&(r.style.display="none")}}t._loadURLInFrame(e.url,e.gid,e.isBgLaunch,e.aspectRatio,e.so,e.htmlCB),e.isBgLaunch&&t._cmdSwitch({target_gameId:Ct,gid:e.gid,mode:It})},t.dispatchMsgH5=function(e,i,n){t._postMsg(e,B,{cmd:xt,gid:B,cbn:i,d:n})},t.switchViewH5=function(e,i,n,r){e!==i&&t._postMsg(Ct,B,{cmd:Pt,target_gameId:e,gid:i,mode:n,exparams:r})},t.backH5=function(){t._postMsg(Ct,B,{cmd:bt})},t._genSubViewId=function(e){var t=gt;return void 0!==e&&null!==e&&(t+=e),t},t.addSubView=function(i,n,r,a,o,s,c){var d=t._genSubViewId(c),u=document.getElementById(d);if(void 0===u||null===u){var l=document.createElement("div");l.setAttribute("id","if_div");var p="-webkit-overflow-scrolling: touch;position:absolute;border:none";p+=Gt.prop(e.PROP_PLATFORM)==e.IOS?";overflow:scroll":";overflow:hidden",p+=";width:"+a+"px",p+=";height:"+o+"px",l.setAttribute("style",p),l.style.top=n+"px",l.style.left=r+"px",document.body.appendChild(l),u=document.createElement("iframe"),u.setAttribute("id",t._genSubViewId(c)),u.setAttribute("src",i);var f="border:none";f+=";-webkit-overflow-scrolling: touch;width:100%;height:100%",u.setAttribute("style",f),l.appendChild(u),u.onload=s}else{u.setAttribute("src",i);var f="border:none";f+=";-webkit-overflow-scrolling: touch;width:100%;height:100%",u.setAttribute("style",f),void 0!==s&&null!==s&&s()}},t.removeSubView=function(e){var i=t._genSubViewId(e),n=document.getElementById(i);if(n){var r=document.getElementById("if_div");document.body.removeChild(r)}},t.topID=function(){return Ft.length>0?Ft[Ft.length-1]:Jt.length>0?Jt[Jt.length-1]:void 0},t.pause=function(e){var i=e?e:t.topID();t._postMsg(i,B,{cmd:St})},t.resume=function(e){var i=e?e:t.topID();t._postMsg(i,B,{cmd:Ot})},t.forceClose=function(e){if(Kt++,1!=Jt.length){if(B!=Ct)return void h("!! no permission clearAll");for(;0!=Ft.length;){var i,n=Ft.pop();Ft.length>0?(i=Ft[Ft.length-1],t._closeclose(n,i,!1)):(i=Jt[Jt.length-1],t._closeclose(n,i,!0))}for(;Jt.length>=2;){var n=Jt.pop(),i=Jt[Jt.length-1];t._closeclose(n,i,!0)}t._hiddenExitBtn()}},t}();__reflect(Ht.prototype,"SFH5Support");var Gt,Kt=0,jt=function(){function e(){}return e.comInit=function(e){Ht.registerEventListener(),e.complete&&e.complete()},e.dispatchMsg=function(e,t,i,n){Ht.dispatchMsgH5(e,i,n)},e.switchView=function(e,t,i,n){Ht.switchViewH5(e,t,i,n)},e.launchTimeOut=function(){Kt++},e.back=function(){Ht.backH5()},e.addSubView=function(e,t,i,n,r,a,o){Ht.addSubView(e,t,i,n,r,a,o)},e.removeSubView=function(e){Ht.removeSubView(e)},e.pause=function(e){Ht.pause(e)},e.resume=function(e){Ht.resume(e)},e.forceClose=function(e){Ht.forceClose(e)},e.loadErr=function(e){e.flag?Gt.invoke(A,H,[u(H,e.cb,!0),e.msg,e.flag]):Gt.invoke(A,H,[u(H,e.cb,!0),e.msg])},e.appUploadEvent=function(e){Gt.invoke(A,G,[u(G,e.cb,!1),e.url,e.eventData])},e.exit=function(){Gt.invoke(A,K)},e.share=function(e,t){Gt.invoke(w,k,[u(k,t),e])},e.initRetweets=function(e){},e.getMiniProUserInfo=function(e){},e.miniProLogIn=function(e,t){},e}();__reflect(jt.prototype,"comBase");var Wt=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.getKey=function(e){e=e||window.event;var t=e.which?e.which:e.keyCode;27==t&&window[d(j)]&&window[d(j)]()},i.comInit=function(n){t.comInit.call(this,n),document.addEventListener?document.addEventListener("keyup",i.getKey,!1):document.attachEvent?document.attachEvent("onkeyup",i.getKey):document.onkeyup=i.getKey,n.id>0&&(window[d(j)]=function(e){Ht.dispatchMsgH5(0,d(j))});var r=window.localStorage.getItem(e.PROP_DEVICE_ID);r&&0!=r.length||(r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)}),window.localStorage.setItem(e.PROP_DEVICE_ID,r))},i.prop=function(t,i){if(void 0===i){if(i=window.localStorage.getItem(t),!i)switch(t){case e.PROP_RELEASE:return"0";case e.PROP_PLATFORM:return e.WEB;case z:return JSON.stringify([1,6,7,8,12]);case"sys.verName":case"sys.build.osVer":return"web_1.0";case"sys.verCode":return"2";case"sys.pkgName":return"com.sf.new.flat.ios";case"sys.channel":return"snowfish";case"sys.build.model":return"pc";case"issupport":return JSON.stringify({login:["wx","qq"]})}return i}switch(t){case e.PROP_CMD_CLEARDATA:window.localStorage.clear();break;default:null===i||""===i?window.localStorage.removeItem(t):window.localStorage.setItem(t,i)}},i.launch=function(e,t){var i=Kt;setTimeout(function(){return Kt!=i?void h("pplistener skip "+Kt):(Kt++,e.shellCB&&e.shellCB(!0),void(t||Ht.launchH5({url:e.zipUrl.replace(".zip","/")+e.search,gid:e.gid,isBgLaunch:e.isBgLaunch,aspectRatio:e.aspectRatio,so:e.so,htmlCB:e.htmlCB})))},100)},i.invoke=function(e,t,n){switch(t){case $:setTimeout(function(){p(n[0],JSON.stringify({r:vi.STATUS_OK}))},100);break;case Y:switch(parseInt(n[3])){case hi.RewardVideo:case hi.RewardVideoLandscape:case hi.FullVideo:case hi.FullVideoLandscape:i._tmpCnt++;for(var r=i._tmpCnt;r-->0;)p(n[0],JSON.stringify({r:vi.STATUS_CLICK_AD}));var a=confirm("sdk:"+n[1]+" type:"+n[3]+" code:"+n[2]+" 播放广告 成功？");p(n[0],JSON.stringify({r:a?vi.STATUS_OK:vi.STATUS_ERR,msg:"simulate"}));break;case hi.NativeExpress:if(!this._expressAD){this._expressAD=document.createElement("div"),this._expressAD.style.cssText="border:white;padding:4px;overflow-y:auto;z-index:1000000;background:rgba(100,100,100,0.9);color:white;position: absolute;",document.body.appendChild(this._expressAD);var o=document.createElement("button");o.innerText="模拟用户点击‘不喜欢’",o.style.cssText="z-index:1000001;position: absolute;left:30px;top:100px;",o.onclick=function(){var e=i._expressAD.style;""===e.display&&(e.display="none",i._expressCallback&&(p(i._expressCallback,JSON.stringify({r:vi.STATUS_OK,msg:"da close"})),i._expressCallback=null))},this._expressAD.appendChild(o);var s=document.createElement("button");s.innerText="模拟通知游戏 广告已显示",s.style.cssText="z-index:1000001;position: absolute;left:30px;top:50px;",s.onclick=function(){var e=i._expressAD.style;""===e.display&&i._expressCallback&&p(i._expressCallback,JSON.stringify({r:vi.STATUS_ONSHOW}))},this._expressAD.appendChild(s)}this._expressCallback=n[0],this._expressAD.style.display="",this._expressAD.style.left=n[4].x,this._expressAD.style.top=n[4].y,this._expressAD.style.width=n[4].w,this._expressAD.style.height=n[4].h;break;case hi.Banner:if(!this._bannerAD){this._bannerAD=document.createElement("div"),this._bannerAD.style.cssText="border:white;padding:4px;overflow-y:auto;z-index:1000000;background:rgba(100,100,100,1);color:white;position: absolute;",document.body.appendChild(this._bannerAD);var c=document.createElement("label");c.innerText="banner广告显示成功",c.style.cssText="z-index:1000001;position: absolute;left:30px;top:10px;",this._bannerAD.appendChild(c)}h(" real:"+window.innerWidth+"x"+window.innerHeight+" vs "+n[4].iw+"x"+n[4].ih);var d=n[4].ih*window.innerWidth/n[4].iw;this._bannerAD.style.display="",this._bannerAD.style.left=0,this._bannerAD.style.top=window.innerHeight-d+"px",this._bannerAD.style.width=window.innerWidth+"px",this._bannerAD.style.height=d+"px"}break;case Z:this._expressAD&&(this._expressAD.style.display="none"),this._bannerAD&&(this._bannerAD.style.display="none"),i._expressCallback&&(p(i._expressCallback,JSON.stringify({r:vi.STATUS_OK,msg:"ui close"})),i._expressCallback=null);break;case nt:i._tmpCnt++;var u=n[1],l=n[4],a=confirm("模拟支付 成功？");p(n[0],JSON.stringify({r:a?"ok":"fail",msg:"simulate",orderId:l,productId:u}));break;case k:i._tmpCnt++,i._tmpCnt%2?(h("simulate share success"),p(n[0],JSON.stringify({r:"ok"}))):(h("simulate share fail"),p(n[0],JSON.stringify({r:"fail"})));break;case F:var f=0,_=function(){++f<100?(setTimeout(_,30),p(n[0],JSON.stringify({r:"progress",percent:++f}))):("3"==n[1]&&i.prop("sfhomeres",n[4]),p(n[0],JSON.stringify({r:"ok"})))};_();break;case J:window.location.replace(n[2]);break;case K:window.location.reload();break;case H:break;default:switch(e){case O:break;default:n&&n[0]&&(h("! not support:"+e+" "+t+" arg:"+JSON.stringify(n)),p(n[0],JSON.stringify({r:"fail",msg:"not support!"})))}}},i.hutuiAct=function(e){},i._tmpCnt=0,i}(jt);__reflect(Wt.prototype,"comH5");var qt=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prop=function(t,i){if(t==e.PROP_PLATFORM)return""+e.IOS;if(void 0===i){var n=prompt(m+t,"");return n&&""!==n&&"$sf$removeItem"!=n?n:null}return null===i||""===i?(prompt(m+t,"$sf$removeItem"),null):(prompt(m+t,i),i)},i.launch=function(e,t){var n=Kt;i.invoke(A,At,[e.zipUrl,u("pplistener",function(i){if(Kt!=n)h("pplistener skip "+n+"vs"+Kt+" "+i);else{h("pplistener "+i),Kt++;var r=i?!0:!1,a={url:i+e.search,gid:e.gid,isBgLaunch:e.isBgLaunch,aspectRatio:e.aspectRatio,so:e.so,htmlCB:e.htmlCB};e.shellCB&&e.shellCB(r),!t&&r&&Ht.launchH5(a)}},!0),e.zipVer,e.gid])},i.invoke=function(e,t,i){var n={functionName:e+t,arguments:i},r=JSON.stringify(n);c(m+r)},i.hutuiAct=function(e){$t.onEvent("hutuiAct"),4===e.type?Zt.getJSON(e.src,function(e,t,n){t&&i.invoke(A,"hutuiAct",[t.link])}):(5===e.type||6===e.type)&&i.invoke(A,"hutuiAct",[e.src])},i}(jt);__reflect(qt.prototype,"comIOS");var Xt=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prop=function(t,i){if(t==e.PROP_PLATFORM)return""+e.ANDROID;if(void 0===i){var n=window.sfImp.getProperty(t);return n&&""!==n?n:null}null===i||""===i?window.sfImp.setProperty(t,""):window.sfImp.setProperty(t,i)},i.launch=function(e,t){var n=Kt;i.invoke(A,At,[e.zipUrl,u("pplistener",function(i){if(Kt!=n)h("pplistener skip "+n+"vs"+Kt+" "+i);else{h("pplistener "+i),Kt++;var r=JSON.parse(i),a=r.url?!0:!1,o={url:r.url+e.search,gid:e.gid,isBgLaunch:e.isBgLaunch,aspectRatio:e.aspectRatio,so:e.so,htmlCB:e.htmlCB};e.shellCB&&e.shellCB(a),!t&&a&&Ht.launchH5(o)}},!0),e.zipVer,e.gid])},i.invoke=function(e,t,i){var n={functionName:e+t,arguments:i},r=JSON.stringify(n);c(m+r)},i.hutuiAct=function(e){$t.onEvent("hutuiAct"),i.invoke(A,"hutuiAct",[e])},i}(jt);__reflect(Xt.prototype,"comAndr"),e.log=h;var Qt=function(){function t(){}return t.remapKey=function(t){return zt.isSingle?Mt+"##"+zt.id+"#"+t:Mt+"#"+zt.prop(e.PROP_UID)+"#"+zt.id+"#"+t},t.setItem=function(e,t){zt._checkEnv("sfLocalStorage.setItem:"+e),Gt.prop(this.remapKey(e),t)},t.getItem=function(e){zt._checkEnv("sfLocalStorage.getItem:"+e);var t=Gt.prop(this.remapKey(e));return void 0===t||"string"==typeof t&&0==t.length?null:t},t.removeItem=function(e){Gt.prop(this.remapKey(e),null)},t.clear=function(){Gt.prop(e.PROP_CMD_CLEARDATA,!0)},t.getJSON=function(e){try{return JSON.parse(this.getItem(e))}catch(t){return}},t.setJSON=function(e,t){t?this.setItem(e,JSON.stringify(t)):this.removeItem(e)},t}();e.sfLocalStorage=Qt,__reflect(Qt.prototype,"$SF.sfLocalStorage");var zt=function(){function t(){}return t.getUrlParam=function(i){if(!t._requestParams[i])switch(i){case e.PROP_CHECK:return"NO";case P:return"2";case e.PROP_EN_EFFECT:return"true";case e.PROP_EN_MUSIC:return"true";case e.PROP_APP_VER:return Gt.prop(e.PROP_APP_VER);case e.PROP_UID:return""}return t._requestParams[i]},t.setUrlParam=function(e,i){t._requestParams[e]=decodeURI(i)},t.initParams=function(e){if(e&&-1!=e.indexOf("?"))for(var i=e.substr(1),n=i.split("&"),r=0;r<n.length;r++){var a=n[r].split("=")[0],o=n[r].substr(a.length+1);t.setUrlParam(a,o)}},t.initPId=function(){return n(),U},t._checkEnv=function(e){this._inited||alert(e+"之前, 请先调用$SF.Ga.init(...)")},t.init=function(i){t._id=i.id,t._isFirstStart=!0,Jt[0]=Ct,B=i.id,t.initParams(window.location.search),t.initPId(),t._isSingle=window==window.parent,r({complete:function(){if(M=Gt.prop(e.PROP_RELEASE),null===M&&(M=1),window.egret){var n=window.egret;V=function(){n.lifecycle.contexts[0].pause()},L=function(){n.lifecycle.contexts[0].resume()}}else if(window.Laya){var r=window.Laya;L=function(){r.stage._isFocused=!0,r.stage.event("focus"),r.stage.event("focuschange")},V=function(){r.stage._isFocused=!1,r.stage.event("blur"),r.stage.event("focuschange")}}else L=function(){window.focus()},V=function(){window.blur()};t._isSingle&&(h("[Ga] init"),window[d(W)]=function(){Gt.pause()},window[d(q)]=function(){Gt.resume()}),t._inited=!0,i.complete&&i.complete(),t.daInit(t._id,function(e){h("[Ga] daInit r:"+e)})}})},Object.defineProperty(t,"id",{get:function(){return t._id},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isSingle",{get:function(){return t._isSingle},enumerable:!0,configurable:!0}),t.back=function(e){Gt.back()},t.prop=function(i,n){if(!this._isSingle)switch(i){case e.PROP_TOKEN:case e.PROP_UID:case e.PROP_USER_NAME:case e.PROP_USER_ICON_URL:case e.PROP_CHECK:case e.PROP_EN_EFFECT:case e.PROP_EN_MUSIC:case e.PROP_APP_VER:return t.getUrlParam(i);case e.PROP_RETRY_CNT:return t.getUrlParam(P)}return i==e.PROP_RELEASE&&void 0!==n&&(M=n),Gt.prop(i,n)},t.startVib=function(i){return t._isSingle&&h("[Ga] startVib:"+i),Gt.prop(e.PROP_CMD_VIB,i?i:20)},t.onLoadingProgress=function(e){t._isSingle?(this._checkEnv("onLoadingProgress"),h("[Ga] onLoadingProgress:"+JSON.stringify(e)),Gt.prop("cmd.loading",""+Math.floor(100*e.loadCur/e.loadMax))):Gt.dispatchMsg(Ct,t._id,d(pt),{gid:t._id,loadCur:e.loadCur,loadMax:e.loadMax})},t.onGameStart=function(e){if(t._isSingle)this._checkEnv("onGameStart"),h("[Ga] onGameStart"),e({r:!0});else{var i=function(i){h("[focus] try game focus in onGameStart"),Gt.resume(t._id),e&&e(i)};Gt.dispatchMsg(Ct,t._id,d(ut),{gid:t._id,first:t._isFirstStart,cbn:l(st+ut,i)})}t._isFirstStart=!1},t.onGameEnd=function(e,i){if(t._isSingle)this._checkEnv("onGameEnd"),h("[Ga] onGameEnd:"+JSON.stringify(e)),i({r:!0});else{var n=function(e){h("[focus] try game focus in onGameEnd"),Gt.resume(t._id),i&&i(e)};Gt.dispatchMsg(Ct,t._id,d(dt),{gid:t._id,sc:e.score,win:e.win,level:e.level,cbn:l(st+dt,n)})}},t.startShare=function(e,i){if(t._isSingle)h("[Ga] startShare:"+JSON.stringify(e)),i({r:!1});else{var n=function(e){h("[focus] try game focus in startShare"),Gt.resume(t._id),i&&i(e)};Gt.switchView(Ct,t._id,It,""),Gt.dispatchMsg(Ct,t._id,d(lt),{gid:t._id,cbn:l(st+lt,n)})}},t.hutuiReq=function(n,r){var a=t.prop(e.PROP_APP_VER);if(a){var o=function(e){h("onGetHutui data"+JSON.stringify(e)),r&&r(e)};Gt.dispatchMsg(Ct,t._id,d(ht),{cnt:t._hutuiReqCnt++,data:n,gid:t._id,cbn:l(st+ht,o)})}else{var s=t.prop(e.PROP_UID),c={poss:n,gId:""+t._id,uId:s?s:"",pId:i(),channel:""},u=("1"==Gt.prop("ga_url_type")?Tt:kt)+Rt,p=function(e,t,i){t&&r&&r(t)};Zt.postJSONEx(u,!1,JSON.stringify(c),p)}},t.hutuiAct=function(n){if(t._isSingle){var r=("1"==Gt.prop("ga_url_type")?Tt:kt)+Nt,a=t.prop(e.PROP_UID),o={gId:""+t._id,pId:i(),userId:a?a:"",type:1,cbData:n.cbData};Zt.postJSONEx(r,!1,JSON.stringify(o)),Gt.hutuiAct(n)}else Gt.dispatchMsg(Ct,t._id,d(ft),{data:n,gid:t._id})},t.onPause=function(e){l(X,e)},t.onResume=function(e){l(Q,e)},t.postHomeMsg=function(e,i,n){if(t._isSingle)h("[Ga] postHomeMsg id:"+e+" data:"+JSON.stringify(i)),n({r:!1});else{var r=function(e){h("[focus] try game focus in onGetParam"),e&&!e.inBackFlag&&Gt.resume(t._id),n&&n(e.extra)};Gt.dispatchMsg(Ct,t._id,d(Ut),{gid:t._id,msgId:e,msgD:i,cbn:l(st+Ut+e,r)})}},Object.defineProperty(t,"daUserToken",{get:function(){return wi.userToken},enumerable:!0,configurable:!0}),t.daInit=function(e,i){if(t._isSingle){if(wi.initing)return void(i&&i(Oi.BusyInit));if(wi.inited)return void(i&&i(Oi.Success));wi.init(e,function(e){i&&i(e?Oi.Success:Oi.InitFail)})}else i&&i(Oi.Success)},t._postPlayDa=function(e,i,n){var r=function(e){Gt.resume(t._id),n&&n(e.r)};Gt.dispatchMsg(Ct,t._id,d(tt),{gid:t._id,p:e,up:i,cbn:l(""+e,r)})},t.playFullVideo=function(e,i,n){var r=this;void 0===n&&(n=!1),t._isSingle?(this._checkEnv("playFullVideo"),wi.inited?wi.play(this._id,n?bi.FullVideoLandscape:bi.FullVideoPortrait,e,function(e){i(e.s,e.p)}):wi.init(this._id,function(t){t?r.playFullVideo(e,i,n):i(Oi.InitFail)})):this._postPlayDa(n?bi.FullVideoLandscape:bi.FullVideoPortrait,e,i)},t.playRewardVideo=function(e,i,n){var r=this;void 0===n&&(n=!1),t._isSingle?(this._checkEnv("playRewardVideo"),wi.inited?wi.play(this._id,n?bi.RewardVideoLandscape:bi.RewardVideoPortrait,e,function(e){i(e.s,e.p)}):wi.init(this._id,function(t){t?r.playRewardVideo(e,i,n):i(Oi.InitFail)})):this._postPlayDa(n?bi.RewardVideoLandscape:bi.RewardVideoPortrait,e,i)},t.showBa=function(e,i,n){var r=this;t._isSingle?(this._checkEnv("showBa"),wi.inited?wi.play(this._id,i?bi.BaTop:bi.BaBottom,e,function(e){n&&n(e.s)}):wi.init(this._id,function(t){t?r.showBa(e,i,n):n(Oi.InitFail)})):this._postPlayDa(i?bi.BaTop:bi.BaBottom,e,n)},t.hideBa=function(){t._isSingle?(this._checkEnv("hideBa"),wi.hideBa()):Gt.dispatchMsg(Ct,t._id,d(it),{gId:t._id})},t.loadNativeBanner=function(e,i){var n=this;t._isSingle&&(this._checkEnv("loadNativeBanner"),wi.inited?wi.play(this._id,bi.NativeBa,e,function(e){i(e.s,e.adData)}):wi.init(t._id,function(t){t?n.loadNativeBanner(e,i):i(Oi.InitFail,"")}))},t.getADMsg=function(e){switch(e){case Oi.BusyInit:return"初始化忙";case Oi.NoInit:return"未初始化";case Oi.InitFail:return"初始化失败";case Oi.Success:return"成功";case Oi.Canceled:return"取消操作";case Oi.OutOfAD:return"无可用广告";case Oi.TimeOut:return"播放超时";case Oi.Unknown:return"未知_"+e}},t.noticeShowNativeView=function(e){t._isSingle&&wi.noticeShowNativeView(e)},t.onLoadingErr=function(e){t._isSingle&&Gt.loadErr(e)},t.update=function(e,i){t._isSingle&&Gt.invoke(A,F,[u(F+e.gid+e.type,i,!1),e.type?e.type:x.H5App,e.gid,e.url,e.ver,e.verf?e.verf:"0"])},t.restart=function(e){t._isSingle&&Gt.invoke(A,J,[e.type?e.type:x.H5App,e.gid,e.url,e.ver])},t.exit=function(){t._isSingle&&Gt.exit()},t.onKeyBack=function(e){t._isSingle&&u(j,e,!1)},t.addView=function(e){t._isSingle&&Gt.addSubView(e.url,e.top,e.left,e.w,e.h,e.onload,e.viewId)},t.removeView=function(e){t._isSingle&&Gt.removeSubView(e.viewId)},t.initRetweets=function(e){Gt.initRetweets(e)},t.retweetsReq=function(e){l(N,e,!1)},t.miniProLogIn=function(e,t){Gt.miniProLogIn(e,t)},t.getMiniProUserInfo=function(e){Gt.getMiniProUserInfo(e)},t._inited=!1,t._hutuiReqCnt=0,t._isFirstStart=!0,t._requestParams={},t.localStorage=Qt,t}();e.Ga=zt,__reflect(zt.prototype,"$SF.Ga");var $t=function(){function e(){}return e.onEvent=function(e){Gt.invoke(O,"onEvent",[e])},e.onEventWithParameters=function(e,t){Gt.invoke(O,"onEventWithParameters",[e,t])},e.trackingRegisterUid=function(e){Gt.invoke(O,"trackingRegisterUid",[e])},e.trackingLoginUid=function(e){Gt.invoke(O,"trackingLoginUid",[e])},e.trackingonEvent=function(e){Gt.invoke(O,"trackingonEvent",[e])},e.trackingDAEvent=function(e,t,i,n){Gt.invoke(O,"trackingDAEvent",[e,t,i,n])},e}();e.Analytics=$t,__reflect($t.prototype,"$SF.Analytics");var Yt=function(){function e(){}return e._createXHR=function(){return new XMLHttpRequest},e._defaultAjaxSuccessHandler=function(){},e._defaultAjaxErrorHandler=function(){},e._defaultAjaxCompleteHandler=function(){},e._xhrJsonHandler=function(e){return JSON.parse(e._xhr.responseText)},e._xhrJsonJFBHandler=function(e){return JSON.parse(y(e._xhr.response))},e._xhrXmlHandler=function(e){return e._xhr.responseXML},e._xhrHtmlHandler=function(e){return e._xhr.responseText},e._xhrJsonPHandler=function(e){},e._xhrTextHandler=function(e){return e._xhr.responseText},e._xhrNoneHandler=function(e){return null},e._ajaxDataFilter=function(e){return e},e.prototype.start=function(){var e=this,t=e._xhr;if(e.hasDone=!1,e.username?t.open(e.type,e.url,e.async,e.username,e.password):t.open(e.type,e.url,e.async),e.mimeType&&t.overrideMimeType(e.mimeType),e.data&&e.contentType&&t.setRequestHeader("Content-Type",e.contentType),e.ifModified&&t.setRequestHeader("If-Modified-Since",e.ifModified),"xml"==e.dataType?t.responseType="document":("jfb"==e.dataType||"arraybuffer"==e.dataType)&&(t.responseType="arraybuffer"),e.accepts&&e.accepts.length>0){for(var i="",n=0;n<e.accepts.length;n++)n>0&&(i+=", "),i+=e.accepts[n];t.setRequestHeader("Accept",i)}if(e.headers)for(var r in e.headers)void 0!==r&&e.headers.hasOwnProperty(r)&&void 0!==e.headers[r]&&t.setRequestHeader(r,e.headers[r]);var a=void 0;e.timeout&&e.timeout>0&&(a=setTimeout(function(){clearTimeout(a),e.hasDone=!0,t.abort(),e.error(e,"timeout"),e.complete(e,"timeout")},e.timeout)),t.onreadystatechange=function(){if(4!=t.readyState||e.hasDone)3==t.readyState&&e.partial&&e.partial(t.responseText,"partial");else{e.hasDone=!0,void 0!==a&&clearTimeout(a);var i=e._xhrMapHttpStatus(e._xhr);
if((""==t.responseType||"text"==t.responseType)&&null==t.responseText||0==t.status)e.error(e,i,"");else{var n=e.statusCode[t.status];if(n)n(e,i);else if(200==t.status||206==t.status||e.ifModified&&304==t.status){var r=!1;try{304!=t.status&&(e.partial&&e.partial(t.responseText,"done"),e.resultData=e.resultHandler(e))}catch(o){r=!0,e.error(e,i,o)}r||e.success(e.dataFilter(e.resultData,e),i,e)}else e.error(e,i,t.statusText)}e.complete(e,i)}};try{e.data?t.send(e.data):t.send()}catch(o){e.hasDone=!0,e.error(e,"error",o.toString()),e.complete(e,"error")}},e.prototype.abort=function(){var e=this;e.hasDone||!e._xhr||2!=e._xhr.readyState&&3!=e._xhr.readyState||(e.hasDone=!0,e._xhr.abort(),e.error(e,"abort"),e.complete(e,"abort"))},e.prototype.done=function(e){return this.success=e,this},e.prototype.fail=function(e){return this.error=e,this},e.prototype.always=function(e){return this.complete=e,this},e.prototype._xhrMapHttpStatus=function(e){if((""==e.responseType||"text"==e.responseType)&&null==e.responseText||0==e.status)return"error";var t=e.status;return 200==t||206==t?"success":304==t?"notmodified":"error"},e}();__reflect(Yt.prototype,"FWXHR");var Zt=function(){function e(){}return e.ajax=function(e,t){var i=new Yt;return i.url=e,i.type=t.type||"GET",i.async=void 0===t.async?!0:t.async,i.dataType=t.dataType||"html",i.contentType=t.contentType||"application/x-www-form-urlencoded; charset=UTF-8",i.data=t.data,i.password=t.password||void 0,i.username=t.username||void 0,i.statusCode=t.statusCode||{},i.timeout=t.timeout||void 0,i.cache=t.cache||!1,i.accepts=t.accepts||[],i.headers=t.headers||{},i.mimeType=t.mimeType,i.success=t.success||Yt._defaultAjaxSuccessHandler,i.error=t.error||Yt._defaultAjaxErrorHandler,i.complete=t.complete||Yt._defaultAjaxCompleteHandler,i.ifModified=t.ifModified,i.dataFilter=t.dataFilter||Yt._ajaxDataFilter,i.partial=t.partial||void 0,t.resultHandler?i.resultHandler=t.resultHandler:"html"==i.dataType?i.resultHandler=Yt._xhrHtmlHandler:"xml"==i.dataType?i.resultHandler=Yt._xhrXmlHandler:"json"==i.dataType?i.resultHandler=Yt._xhrJsonHandler:"text"==i.dataType?i.resultHandler=Yt._xhrTextHandler:"jfb"==i.dataType&&(i.resultHandler=Yt._xhrJsonJFBHandler),i.resultHandler=i.resultHandler||Yt._xhrNoneHandler,i.jsonp||(i._xhr=Yt._createXHR()),(void 0===t.start||1==t.start)&&i.start(),i},e.getJSON=function(t,i,n,r){var a=Date.now(),o={type:"GET",async:!0,success:function(e,t,n){i&&i(n,e,Date.now()-a)},error:function(e,t){i&&i(e,void 0,Date.now()-a)},timeout:n?n:15e3,headers:r};e.ajax(t,o)},e.postJSONEx=function(t,i,n,r,a,o){var s=Date.now(),c={type:"POST",async:!0,success:function(e,t,i){r&&r(i,e,Date.now()-s)},error:function(e,t){r&&r(e,void 0,Date.now()-s)},timeout:a?a:15e3,headers:o};c.data=n,i?(c.data=v(n),c.dataType="jfb",c.accepts=["application/vnd+sf+jfb"],c.contentType="application/vnd+sf+jfb"):(c.data=n,c.dataType="json",c.contentType="application/json; charset=UTF-8"),e.ajax(t,c)},e}();e.XMLHttp=Zt,__reflect(Zt.prototype,"$SF.XMLHttp");var ei=8,ti=[172,167,71,90,56,85,105,170,34,175,243,95,129,101,237,241],ii="https://das-f.appgames.cn:9501/das/a/",ni="https://testfsbn.snowfish.cn:9501/das/a/",ri="i/",ai="b/",oi="e/",si="up/",ci="prop.da.config.v2",di="prop.da.ga_",ui="prop.da.uToken",li="prop.da.session",pi={},fi=function(){function e(){}return e}();__reflect(fi.prototype,"AdCodeEx");var hi=function(){function e(){}return e.MODE_COUNT=1,e.MODE_WEIGHT=2,e.NativeBanner=1,e.Banner=2,e.RewardVideo=5,e.RewardVideoLandscape=8,e.FullVideo=6,e.FullVideoLandscape=9,e.NativeExpress=10,e}();__reflect(hi.prototype,"AdCode");var _i=function(){function e(){}return e}();__reflect(_i.prototype,"AdPointConf");var gi=function(){function e(){}return e}();__reflect(gi.prototype,"AdSdkPolicy");var vi=function(){function e(){}return e.STATUS_UNKNOWN=0,e.STATUS_PROMPTED=1,e.STATUS_OK=2,e.STATUS_CANCELED=3,e.STATUS_OUT_OF_AD=4,e.STATUS_TIMEOUT=5,e.STATUS_CLICK_AD=6,e.STATUS_ERR=7,e.STATUS_EXCEPTION=8,e.STATUS_ONSHOW=9,e}();e.AdShowInfo=vi,__reflect(vi.prototype,"$SF.AdShowInfo");var yi=function(){function e(){}return e}();__reflect(yi.prototype,"UsrPosToGroup");var mi=function(){function e(){}return e.PRELOAD_MODE_LEGACY=0,e.PRELOAD_MODE_STRICT_NO_FALLBACK=1,e}();__reflect(mi.prototype,"AdPolicySDKControl");var wi=function(){function t(){}return Object.defineProperty(t,"initing",{get:function(){return this._initing},enumerable:!0,configurable:!0}),Object.defineProperty(t,"inited",{get:function(){return this._inited},enumerable:!0,configurable:!0}),Object.defineProperty(t,"userToken",{get:function(){return Gt.prop(ui)},set:function(e){Gt.prop(ui,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t,"cfgVer",{get:function(){return this._data.ver},enumerable:!0,configurable:!0}),t.getDaData=function(){var e=Gt.prop(ci);return e?JSON.parse(e):{ver:"",posList:[],codes:[],policyMap:{},today:0}},t.saveDaData=function(){Gt.prop(ci,JSON.stringify(this._data))},Object.defineProperty(t,"session",{get:function(){return Gt.prop(li)},set:function(e){Gt.prop(li,e)},enumerable:!0,configurable:!0}),t._forceCode=function(e){if(this._controls)for(var t=0;t<this._controls.length;t++)if(this._controls[t].aid==e&&this._controls[t].p==mi.PRELOAD_MODE_STRICT_NO_FALLBACK)return!0;return!1},t.getPreloadDA=function(e){var t=e.code;return pi[t.aid]||(pi[t.aid]={}),pi[t.aid][t.at]||(pi[t.aid][t.at]={dc:null}),pi[t.aid][t.at].dc},t.preloadDA=function(e){var t=e.code;if(t.at!=hi.NativeExpress||this._uiScale){pi[t.aid]||(pi[t.aid]={}),pi[t.aid][t.at]||(pi[t.aid][t.at]={dc:null}),pi[t.aid][t.at].dc=null;var i,n=function(i){var n;n=f(i)?t.at==hi.NativeBanner?{r:vi.STATUS_OK,msg:i}:JSON.parse(i):{r:parseInt(i),msg:void 0},n.r==vi.STATUS_OK&&(pi[t.aid][t.at].dc=e)};i=this._group<0||this._group>=t.ct.length?0:t.ct[this._group]?this._group:0;var r;t.p&&(r=JSON.parse(JSON.stringify(t.p))),t.at==hi.NativeExpress&&(r.x=r.x*this._uiScale,r.y=r.y*this._uiScale,r.w=r.w*this._uiScale,r.h=r.h*this._uiScale),Si.preload(t.aid,t.ct[i],t.at,r,n)}},t.playDA=function(e,t,i){var n=t.code;if(n.at==hi.NativeExpress&&!this._uiScale)return void i({r:vi.STATUS_EXCEPTION,msg:"未设置uiScale"});pi[n.aid]||(pi[n.aid]={}),pi[n.aid][n.at]||(pi[n.aid][n.at]={dc:null}),pi[n.aid][n.at].dc=null;var r,a=function(e){h("isstr:"+("string"==typeof e));var t;f(e)?n.at==hi.NativeBanner?(t={r:vi.STATUS_OK,msg:e},h("playDA cb NativeBanner succ")):(t=JSON.parse(e),h("playDA cb r:"+t.r+" msg:"+t.msg)):t={r:parseInt(e),msg:void 0},i(t)};r=this._group<0||this._group>=n.ct.length?0:n.ct[this._group]?this._group:0;var o;n.p&&(o=JSON.parse(JSON.stringify(n.p))),n.at==hi.NativeExpress&&(o.x=o.x*this._uiScale,o.y=o.y*this._uiScale,o.w=o.w*this._uiScale,o.h=o.h*this._uiScale),Si.play(n.aid,n.ct[r],n.at,o,e,a)},t.rstCode=function(){for(var e in this._data.policyMap)this._data.policyMap[e].en=!0,this._data.policyMap[e].cc=0,this._data.policyMap[e].crts=0},t.rstCodeIfAllDisable=function(){var e=!0;for(var t in this._data.policyMap)if(this._data.policyMap[t].en){e=!1;break}e&&this.rstCode()},t._getCode=function(e){for(var t=0;t<this._data.codes.length;t++){var i=this._data.codes[t];if(i.cid==e)return i}return null},t.getCurCode=function(e,t){for(var i=0,n=function(n){var a=e[n].code,o=r._data.policyMap[a.aid];if(!o.en)return"continue";var s=!1;return t.forEach(function(e){e==a.aid&&(s=!0)}),s?"continue":o.cc<o.c&&o.m&hi.MODE_COUNT?{value:e[n]}:void(o.m&hi.MODE_WEIGHT&&(i+=o.w))},r=this,a=0;a<e.length;a++){var o=n(a);if("object"==typeof o)return o.value}for(var s=Math.random()*i,c=function(i){var n=e[i].code,r=d._data.policyMap[n.aid];if(!r.en)return"continue";var a=!1;if(t.forEach(function(e){e==n.aid&&(a=!0)}),a)return"continue";if(r.m&hi.MODE_WEIGHT){if(s<r.w)return{value:e[i]};s-=r.w}},d=this,a=0;a<e.length;a++){var u=c(a);if("object"==typeof u)return u.value}return null},t.selectCode=function(e,t,i,n){var r=this._data.posList;do{if(!r)break;var a=Math.floor(Date.now()/864e5);if(this._data.today!=a){this._data.today=a;for(var o in this._data.policyMap)this._data.policyMap[o].en=!0,this._data.policyMap[o].cc=0,this._data.policyMap[o].crts=0,this._data.policyMap[o].tc=0}for(var s=void 0,c=0;c<r.length;c++)if(r[c].p==t){s=r[c];break}if(!s)break;var d=this._getCodeGroup(e,t,i,s);return this.getCurCode(d,n)}while(0);return h("~~ da selectCode null:"+t+" codes:"+JSON.stringify(r)+" cfg:"+JSON.stringify(this._data.policyMap)),this.rstCode(),null},t.playDAWithRetry=function(e,t,i,n,r){switch(t){case bi.FullVideoPortrait:case bi.FullVideoLandscape:case bi.RewardVideoPortrait:case bi.RewardVideoLandscape:this.playDAVideo(e,t,i,n,[]);break;default:this.playDANotVideo(e,t,i,n,r,[])}},t.playDANotVideo=function(e,t,i,n,r,a){var o=this,s={p:0,d:0,s:0,c:0,m:0,v:void 0},c=this.selectCode(e,t,i,a);if(c){t==bi.ExpressAD&&(c.code.p.x=r.x,c.code.p.y=r.y);var d,u=Date.now(),l=this.getPreloadDA(c);d=this._forceCode(c.code.aid)?c:l?l:c,this.playBegin(e,t,i,c,l,this._data.policyMap[c.code.aid].tc,a.length,function(l,p){l?(s.p=p,o.playDA(p,d,function(l){switch(l.r){case vi.STATUS_CLICK_AD:s.c++;break;case vi.STATUS_ONSHOW:d.code.at==hi.NativeExpress&&(s.s=vi.STATUS_ONSHOW,n(s));break;default:switch(s.s=l.r,s.d=Date.now()-u,d.code.at){case hi.NativeBanner:l.r!=vi.STATUS_OK?s.v=l.msg:s.adData=l.msg,s.m=0;break;case hi.NativeExpress:s.v=l.msg,s.m=a.length<o._expressAidCnt?1:0,o.preloadDA(c);break;case hi.Banner:s.v=l.msg,s.m=a.length<o._baAidCnt?1:0;break;default:s.v=l.msg,s.m=0}o.playEnd(s,function(d){switch(d){case 1:a.push(c.code.aid),h("~~ da retry cur_fail:"+c.code.aid),o.playDANotVideo(e,t,i,n,r,a);break;case 0:s.s!=vi.STATUS_OK&&(h("~~ da r:"+s.s+"->OK"),s.s=vi.STATUS_OK);case 2:default:n(s)}})}})):(s.s=vi.STATUS_ERR,n(s))})}else s.s=vi.STATUS_OUT_OF_AD,n(s)},t._onSdkFail=function(e){this._data.policyMap[e].en&&(this._data.policyMap[e].crts>=this._data.policyMap[e].rts?(this._data.policyMap[e].en=!1,h("~~ da disable :"+e)):this._data.policyMap[e].crts++)},t.playDAVideo=function(e,t,i,n,r){var a=this,o={p:0,d:0,s:0,c:0,m:0,v:void 0},s=this.selectCode(e,t,i,r);if(s){var c,d=Date.now(),u=this.getPreloadDA(s);c=this._forceCode(s.code.aid)?s:u?u:s,this.playBegin(e,t,i,s,this.getPreloadDA(s),this._data.policyMap[s.code.aid].tc,r.length,function(u,l){if(u){if(!a._data.policyMap[s.code.aid])return o.s=vi.STATUS_ERR,void n(o);a.addCC(s.code),o.p=l,a.playDA(l,c,function(c){switch(c.r){case vi.STATUS_CLICK_AD:o.c++;break;case vi.STATUS_ONSHOW:break;default:if(o.s=c.r,o.v=c.msg,o.d=Date.now()-d,o.m=r.length<a._aidCnt?1:0,a.preloadDA(s),o.s==vi.STATUS_OK||o.s==vi.STATUS_CANCELED){var u=a._data.policyMap[s.code.aid];u&&u.tc++}else a._onSdkFail(s.code.aid);a.playEnd(o,function(c){switch(c){case 1:r.push(s.code.aid),h("~~ da retry cur_fail:"+s.code.aid),a.playDAVideo(e,t,i,n,r);break;case 0:o.s!=vi.STATUS_OK&&(h("~~ da r:"+o.s+"->OK"),o.s=vi.STATUS_OK);case 2:default:n(o)}})}})}else o.s=vi.STATUS_UNKNOWN,s.code.at!=hi.Banner&&n(o)})}else o.s=vi.STATUS_OUT_OF_AD,n(o)},t.addCC=function(e){switch(e.at){case hi.RewardVideo:case hi.RewardVideoLandscape:case hi.FullVideo:case hi.FullVideoLandscape:var t=this._data.policyMap[e.aid];t&&t.cc++,this.saveDaData()}},t._autoPreloadDA=function(){for(var t=this._data.codes,i={},n=0;n<t.length;n++){var r=t[n];switch(i[r.aid]||(i[r.aid]={}),r.at){case hi.RewardVideo:case hi.RewardVideoLandscape:i[r.aid].rewardcode||(i[r.aid].rewardcode=r);break;case hi.FullVideo:case hi.FullVideoLandscape:i[r.aid].fullcode||(i[r.aid].fullcode=r);break;case hi.NativeBanner:i[r.aid].nativebannercode||(i[r.aid].nativebannercode=r);break;case hi.NativeExpress:i[r.aid].nativeExpress||(i[r.aid].nativeExpress=r)}}this._baAidCnt=0;for(var a in i){var o=i[a];o.rewardcode&&(h("~~ da preload["+a+"] reward:"+JSON.stringify(o.rewardcode)),this.preloadDA({code:o.rewardcode,codeGroupId:0})),o.fullcode&&(h("~~ da preload["+a+"] full:"+JSON.stringify(o.fullcode)),this.preloadDA({code:o.fullcode,codeGroupId:0})),o.nativebannercode&&(e.log("~~ da preload["+a+"] nativebannercode:"+JSON.stringify(o.nativebannercode)),this.preloadDA({code:o.nativebannercode,codeGroupId:0})),o.baCode&&this._baAidCnt++}},t._updateCfg=function(e){if(e.v!=this._data.ver){this._data.ver=e.v,this._data.posList=e.pl,this._data.codes=e.cl;var t=this._data.policyMap;this._data.policyMap={};for(var i=0;i<e.pyl.length;i++){var n=!1,r=e.pyl[i];for(var a in t)if(a==""+r.aid){t[a].aid=r.aid,t[a].m=r.m,t[a].w=r.w,t[a].c=r.c,t[a].rts=r.rts,void 0===t[a].cc&&(t[a].cc=0),void 0===t[a].crts&&(t[a].crts=0),void 0===t[a].en&&(t[a].en=!0),void 0===t[a].tc&&(t[a].tc=0),this._data.policyMap[a]=t[a],n=!0;break}n||(this._data.policyMap[r.aid]?h("!! ~~  da pyl 2:"+r.aid):(this._data.policyMap[r.aid]=r,this._data.policyMap[r.aid].en=!0,this._data.policyMap[r.aid].cc=0,this._data.policyMap[r.aid].crts=0,this._data.policyMap[r.aid].tc=0))}this.saveDaData()}},t._initSdk=function(){this._aidCnt=0;for(var e in this._data.policyMap)this._aidCnt++,Si.init(parseInt(e))},t._parseClientResp=function(e){e.sid&&(this.session=e.sid),e.cfg&&this._updateCfg(e.cfg)},t._setUserPosIdMap=function(e,t){Gt.prop(di+e,JSON.stringify(t))},t._getUserPosIdMap=function(e){var t=Gt.prop(di+e);return t?JSON.parse(t):[]},t._getCodeGroup=function(e,t,i,n){for(var r=this._getUserPosIdMap(e),a=0,o=0;o<r.length;o+=3){var s=r[o],c=r[o+1];if(s==t&&c==i){a=r[o+2];break}}var d=[],u=n.cl;if(u)for(var o=0;o<u.length;o++){var l=u[o],p=this._getCode(l),f=!1,_=new fi;if(_.codeGroupId=0,_.code=p,0!==a&&n.xcl)for(var g=0;g<n.xcl.length;g++){var v=n.xcl[g],y=v[0];if(a==y){for(var m=1;m<v.length;m++){var w=this._getCode(v[m]);if(p.aid==w.aid){_.codeGroupId=a,_.code=w,f=!0,h("~~ da: remap aid:"+p.aid+" "+p.cid+"->"+w.cid);break}}if(f)break}}d.push(_)}return d},Object.defineProperty(t,"daUrl",{get:function(){return"1"==Gt.prop("ga_url_type")?ni:ii},enumerable:!0,configurable:!0}),t.init=function(i,n){var r=this;this._data=this.getDaData();var a={sid:this.session,lcv:this.cfgVer,pg:Gt.prop("sys.pkgName"),pv:Gt.prop("sys.verName"),ch:Gt.prop("sys.channel"),d:Gt.prop(e.PROP_DEVICE_ID),pu:Gt.prop("umdeviceToken"),vnd:Gt.prop("sys.build.brand"),bm:Gt.prop("sys.build.model"),bv:Gt.prop("sys.build.sdkInt"),ov:Gt.prop("sys.build.osVer"),"if":Gt.prop("sys.prop.idfa"),ot:parseInt(Gt.prop(e.PROP_PLATFORM)),dv:1,sv:Gt.prop("sys.verCode"),cv:Gt.prop(e.PROP_APP_VER)?Gt.prop(e.PROP_APP_VER):void 0,gu:Gt.prop(e.PROP_UID)?Gt.prop(e.PROP_UID):void 0,al:JSON.parse(Gt.prop(z)),u:this.userToken};for(var o in a)null===a[o]&&(a[o]=void 0);var s=this.daUrl+ri;h(s+" ->:"+JSON.stringify(a)),this._initing=!0,e.XMLHttp.postJSONEx(s,!1,JSON.stringify(a),function(e,a,o){r._initing=!1,h(s+" <-:"+JSON.stringify(a)),a&&"OK"==a.r?(r._inited=!0,r._parseClientResp(a),r._group=a.ag,t._initSdk(),t._autoPreloadDA(),r.userToken=a.u,a.pr?r._setUserPosIdMap(i,a.pr):r._setUserPosIdMap(i,[]),a.pc&&a.pc.s?r._controls=a.pc.s:r._controls=[],n&&n(!0)):n&&n(!1)},15e3)},t.updateGame=function(t){var i=this;this._data=this.getDaData();var n={sid:this.session,lcv:this.cfgVer,g:t},r=this.daUrl+si;h(r+" ->:"+JSON.stringify(n)),e.XMLHttp.postJSONEx(r,!1,JSON.stringify(n),function(e,n,a){i._initing=!1,h(r+" <-:"+JSON.stringify(n)),n&&"OK"==n.r&&(i._parseClientResp(n),i._setUserPosIdMap(t,n.pr?n.pr:[]))},15e3)},t.play=function(e,t,i,n,r){this._initing?n({p:0,d:0,c:0,m:0,v:void 0,s:Oi.BusyInit}):this._inited?"1"==Gt.prop("prop.noDA")?n({p:0,d:0,c:0,m:0,v:void 0,s:Oi.Unknown}):(this.rstCodeIfAllDisable(),this.playDAWithRetry(e,t,i,n,r)):n({p:0,d:0,c:0,m:0,v:void 0,s:Oi.BusyInit})},t.hideBa=function(){Si.closePlay()},t.noticeShowNativeView=function(e){Si.showBannerView(e)},t.preloadDa=function(e,t){if(e==bi.ExpressAD){this._uiScale=t;for(var i=this._data.codes,n=void 0,r=0;r<i.length;r++){var a=i[r];if(a.at==hi.NativeExpress){n=a;break}}n&&this.preloadDA({code:n,codeGroupId:0})}},t.playBegin=function(t,i,n,r,a,o,s,c){var d,u=this,l=0;this._forceCode(r.code.aid)?(d=r,l=2):d=a?a:r,a&&a.code.cid==d.code.cid&&(l|=1);var p;p=this._group<0||this._group>=d.code.ct.length?0:d.code.ct[this._group]?this._group:0;var f={sid:this.session,pp:i,rt:s,ct:Date.now(),as:r.code.aid,ac:r.code.cid,cg:r.codeGroupId,pas:d.code.aid,pac:d.code.cid,pat:d.code.at,pak:d.code.ct[p],pag:this._group,pcg:d.codeGroupId,f:l,g:t,up:n,gu:Gt.prop(e.PROP_UID)?Gt.prop(e.PROP_UID):void 0};h(this.daUrl+ai+" ->:"+JSON.stringify(f)),e.XMLHttp.postJSONEx(this.daUrl+ai,!1,JSON.stringify(f),function(e,t,i){h("http <-:"+JSON.stringify(t)),t&&"OK"==t.r?(u._parseClientResp(t),u._group=t.ag,u.trackingDA(t.p,r.code.aid,r.code.at),c(!0,t.p)):c(!1,0)},15e3)},t.playEnd=function(t,i){var n=this,r={sid:this.session,p:t.p,d:t.d,s:t.s,c:t.c,m:t.m,v:t.v};h(this.daUrl+oi+" ->:"+JSON.stringify(r)),e.XMLHttp.postJSONEx(this.daUrl+oi,!1,JSON.stringify(r),function(e,r,a){h("http <-:"+JSON.stringify(r)),r&&"OK"==r.r?(n._parseClientResp(r),i(r.s)):i(t.s)},15e3)},t.trackingDA=function(t,i,n){if(2!=n){var r="";switch(r=r.concat(t+"-",Date.now()+""),n){case hi.RewardVideo:case hi.RewardVideoLandscape:e.Analytics.trackingDAEvent(r,i+"","1",!0);break;case hi.FullVideo:case hi.FullVideoLandscape:e.Analytics.trackingDAEvent(r,i+"","0.5",!0)}}},t._aidCnt=0,t._baAidCnt=0,t._expressAidCnt=0,t._initing=!1,t._inited=!1,t._group=0,t}();__reflect(wi.prototype,"DaManager");var Si=function(){function e(){}return e.init=function(e){Gt.prop("cmd.initadsdk",""+e)},e.preload=function(e,t,i,n,r){Gt.invoke(b,$,[u($+t,r,!0),e,t,i,n])},e.play=function(e,t,i,n,r,a){Gt.invoke(b,Y,[u(Y+t,a,!1),e,t,i,n,r])},e.closePlay=function(){Gt.invoke(b,Z)},e.showBannerView=function(e){Gt.invoke(b,et,[e])},e}();__reflect(Si.prototype,"_ShellDA");var Oi;!function(e){e[e.BusyInit=-3]="BusyInit",e[e.NoInit=-2]="NoInit",e[e.InitFail=-1]="InitFail",e[e.Unknown=0]="Unknown",e[e.Success=2]="Success",e[e.Canceled=3]="Canceled",e[e.OutOfAD=4]="OutOfAD",e[e.TimeOut=5]="TimeOut",e[e.Click=6]="Click",e[e.Err=7]="Err",e[e.Exception=8]="Exception",e[e.OnShow=9]="OnShow"}(Oi=e.ADResult||(e.ADResult={}));var bi;!function(e){e[e.FullVideoPortrait=1]="FullVideoPortrait",e[e.FullVideoLandscape=2]="FullVideoLandscape",e[e.RewardVideoPortrait=3]="RewardVideoPortrait",e[e.RewardVideoLandscape=4]="RewardVideoLandscape",e[e.BaTop=5]="BaTop",e[e.BaBottom=6]="BaBottom",e[e.NativeBa=7]="NativeBa",e[e.ExpressAD=8]="ExpressAD"}(bi=e.EPosID||(e.EPosID={}));var Ai;!function(e){e[e.NONE=0]="NONE",e[e.WIN=1]="WIN",e[e.LOSE=2]="LOSE",e[e.DEUCE=5]="DEUCE"}(Ai=e.PlayResult||(e.PlayResult={}))}($SF||($SF={}));